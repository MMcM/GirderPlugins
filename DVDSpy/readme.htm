<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta http-equiv="Content-Language" content="en-us">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>DVDSpy plug-in</title>
</head>

<body>

<h1>Girder plug-in for software DVD players</h1>
Version 1.13. &nbsp;MMcM 03/02

<h3>Use</h3>

This plug-in intercepts various Windows messages that are used by
WinDVD and PowerDVD to update their own windows with the information
about the DVD currently being played.  When this information has
changed, a Girder event is generated.  The associated information is
placed in Girder registers.<p>

It also intercepts calls to Windows text drawing functions as used by
accessDTV and exposes it similarly.<p>

It wraps DirectX objects used by Zoom Player, TheaterTek, or the newer
versions of the ATI player and exposes the playing state.  This
approach can probably be extended trivially to any other DirectShow
DVD player.<p>

It defines an ActiveX control element for use in Windows Media Player
skins and thereby exposes that player's state when a special skin is
used.<p>

It includes a Winamp general plugin that exposes state changes.<p>

<table border="yes">
<tr><th>Code</th>
<th>Meaning</th>
<th>Register</th>
<th>Integer</th>
<th>String</th>
</tr>

<tr><td>Disc.Insert.<i>X</i>.9</td>
<td>A new DVD was inserted into drive <i>X:</i></td>
<td align="right">9</td>
<td>The volume serial number</td>
<td>The volume name or disc title (see below)</td>
</tr>

<tr><td>Disc.Eject.<i>X</i></td>
<td>The DVD was ejected from drive <i>X:</i></td>
</tr>

<tr></tr>

<tr><td>WinDVD.1</td>
<td>Chapter changed</td>
<td align="right">1</td>
<td></td>
<td>New chapter (NN)</td>
</tr>

<tr><td>WinDVD.2</td>
<td>Elapsed time changed</td>
<td align="right">2</td>
<td></td>
<td>New time (HH:MM:SS)</td>
</tr>

<tr><td>WinDVD.3</td>
<td>Video mode changed</td>
<td align="right">3</td>
<td></td>
<td>New mode (e.g. MPEG)</td>
</tr>

<tr><td>WinDVD.5</td>
<td>Audio mode changed</td>
<td align="right">5</td>
<td></td>
<td>New mode (e.g. BOTH)</td>
</tr>

<tr><td>WinDVD.Close</td>
<td>WinDVD application closed</td>
</tr>

<tr></tr>

<tr><td>PowerDVD.Time.5</td>
<td>Elapsed time changed</td>
<td align="right">5</td>
<td></td>
<td>New time (HH:MM:SS)</td>
</tr>

<tr><td>PowerDVD.Title.7</td>
<td>Title of video window changed</td>
<td align="right">6</td>
<td></td>
<td>New title (file name if playing file instead of disc)</td>
</tr>

<tr></tr>

<tr><td>accessDTV.ChanText.1</td>
<td>The channel description changed</td>
<td align="right">1</td>
<td></td>
<td>New description (NNN.n XXXX_XX)</td>
</tr>

<tr><td>accessDTV.ChanNoText</td>
<td>The channel description was not present</td>
</tr>

<tr><td>accessDTV.Channel.2</td>
<td>The big channel digits changed</td>
<td align="right">2</td>
<td></td>
<td>New digits (NN.n)</td>
</tr>

<tr><td>accessDTV.Close</td>
<td>ADTV application closed</td>
</tr>

<tr></tr>

<tr><td>ZoomPlayer.DVD.1</td>
<td>Domain changed</td>
<td align="right">1</td>
<td></td>
<td>New domain (PLAY,MENU,DVD,STOP)</td>
</tr>

<tr><td>ZoomPlayer.DVD.2</td>
<td>Title changed</td>
<td align="right">2</td>
<td></td>
<td>New title (NN)</td>
</tr>

<tr><td>ZoomPlayer.DVD.3</td>
<td>Chapter changed</td>
<td align="right">3</td>
<td></td>
<td>New chapter (NN)</td>
</tr>

<tr><td>ZoomPlayer.DVD.4</td>
<td>Total changed</td>
<td align="right">4</td>
<td></td>
<td>New total time (HH:MM:SS)</td>
</tr>

<tr><td>ZoomPlayer.DVD.5</td>
<td>Location changed</td>
<td align="right">5</td>
<td></td>
<td>New elapsed time (HH:MM:SS)</td>
</tr>

<tr><td>ZoomPlayer.Media.4</td>
<td>Duration changed</td>
<td align="right">4</td>
<td></td>
<td>New total duration (HH:MM:SS)</td>
</tr>

<tr><td>ZoomPlayer.Media.5</td>
<td>Position changed</td>
<td align="right">5</td>
<td></td>
<td>New current position (HH:MM:SS)</td>
</tr>

<tr><td>ZoomPlayer.Media.6</td>
<td>Source changed</td>
<td align="right">6</td>
<td></td>
<td>New source file name</td>
</tr>

<tr><td>ZoomPlayer.OSD.7</td>
<td>OSD caption changed</td>
<td align="right">7</td>
<td></td>
<td>New OSD message (Play, Pause, ...)</td>
</tr>

<tr><td>ZoomPlayer.Close</td>
<td>ZP application closed</td>
</tr>

<tr></tr>

<tr><td>TheaterTek.1</td>
<td>Domain changed</td>
<td align="right">1</td>
<td></td>
<td>New domain (PLAY,MENU,DVD,STOP)</td>
</tr>

<tr><td>TheaterTek.2</td>
<td>Title changed</td>
<td align="right">2</td>
<td></td>
<td>New title (NN)</td>
</tr>

<tr><td>TheaterTek.3</td>
<td>Chapter changed</td>
<td align="right">3</td>
<td></td>
<td>New chapter (NN)</td>
</tr>

<tr><td>TheaterTek.4</td>
<td>Total changed</td>
<td align="right">4</td>
<td></td>
<td>New total time (HH:MM:SS)</td>
</tr>

<tr><td>TheaterTek.5</td>
<td>Location changed</td>
<td align="right">5</td>
<td></td>
<td>New elapsed time (HH:MM:SS)</td>
</tr>

<tr><td>TheaterTek.Close</td>
<td>TT application closed</td>
</tr>

<tr></tr>

<tr><td>ATI.DVD.1</td>
<td>Domain changed</td>
<td align="right">1</td>
<td></td>
<td>New domain (PLAY,MENU,DVD,STOP)</td>
</tr>

<tr><td>ATI.DVD.2</td>
<td>Title changed</td>
<td align="right">2</td>
<td></td>
<td>New title (NN)</td>
</tr>

<tr><td>ATI.DVD.3</td>
<td>Chapter changed</td>
<td align="right">3</td>
<td></td>
<td>New chapter (NN)</td>
</tr>

<tr><td>ATI.DVD.4</td>
<td>Total changed</td>
<td align="right">4</td>
<td></td>
<td>New total time (HH:MM:SS)</td>
</tr>

<tr><td>ATI.DVD.5</td>
<td>Location changed</td>
<td align="right">5</td>
<td></td>
<td>New elapsed time (HH:MM:SS)</td>
</tr>

<tr><td>ATI.MMC.4</td>
<td>Duration changed</td>
<td align="right">4</td>
<td></td>
<td>New total duration (HH:MM:SS)</td>
</tr>

<tr><td>ATI.MMC.5</td>
<td>Position changed</td>
<td align="right">5</td>
<td></td>
<td>New current position (HH:MM:SS)</td>
</tr>

<tr><td>ATI.MMC.6</td>
<td>Source changed</td>
<td align="right">6</td>
<td></td>
<td>New source file name</td>
</tr>

<tr><td>ATI.Close</td>
<td>ATI application closed</td>
</tr>

<tr></tr>

<tr><td>WMP.Status.1</td>
<td>Media player status changed</td>
<td align="right">1</td>
<td></td>
<td>New player status</td>
</tr>

<tr><td>WMP.Duration.4</td>
<td>Media duration changed</td>
<td align="right">4</td>
<td></td>
<td>New total time (MM:SS)</td>
</tr>

<tr><td>WMP.Position.5</td>
<td>Media player position changed</td>
<td align="right">5</td>
<td></td>
<td>New elapsed time (MM:SS)</td>
</tr>

<tr><td>WMP.URL.6</td>
<td>Media source changed</td>
<td align="right">6</td>
<td></td>
<td>New current media URL</td>
</tr>

<tr><td>WMP.Title.7</td>
<td>Media name changed</td>
<td align="right">7</td>
<td></td>
<td>New current media name</td>
</tr>

<tr><td>WMP.Close</td>
<td>Media player closed</td>
</tr>

<tr></tr>

<tr><td>Winamp.Status.1</td>
<td>Status changed</td>
<td align="right">1</td>
<td></td>
<td>New status (STOP, PLAY, PAUSE)</td>
</tr>

<tr><td>Winamp.Length.2</td>
<td>Playlist length changed</td>
<td align="right">2</td>
<td></td>
<td>New playlist length</td>
</tr>

<tr><td>Winamp.Position.3</td>
<td>Playlist position changed</td>
<td align="right">3</td>
<td></td>
<td>New playlist position (1-based)</td>
</tr>

<tr><td>Winamp.Total.4</td>
<td>Total time changed</td>
<td align="right">4</td>
<td></td>
<td>New total time (MM:SS)</td>
</tr>

<tr><td>Winamp.Elasped.5</td>
<td>Time position changed</td>
<td align="right">5</td>
<td></td>
<td>New elapsed time (MM:SS)</td>
</tr>

<tr><td>Winamp.File.6</td>
<td>Track file changed</td>
<td align="right">6</td>
<td></td>
<td>New current filename</td>
</tr>

<tr><td>Winamp.Title.7</td>
<td>Track title changed</td>
<td align="right">7</td>
<td></td>
<td>New current title</td>
</tr>

<tr><td>Winamp.Close</td>
<td>Program closed</td>
</tr>

<tr></tr>

<tr><td>ShowShifter.4</td>
<td>Duration changed</td>
<td align="right">4</td>
<td></td>
<td>New total duration (HH:MM:SS)</td>
</tr>

<tr><td>ShowShifter.5</td>
<td>Position changed</td>
<td align="right">5</td>
<td></td>
<td>New current position (HH:MM:SS)</td>
</tr>

<tr><td>ShowShifter.6</td>
<td>Source changed</td>
<td align="right">6</td>
<td></td>
<td>New source file name</td>
</tr>

</table><p>

In order for the DirectX wrappers to work, the MEDIASPY.DLL library
must be registered using <kbd>regsvr32</kbd>.  This may impact
programs even when Girder is not running.  Unregistering it should
return things to normal.<p>

In order for the Windows Media Player interface to work, the
WMPSPY.DLL library must be registered in the same way.  It defines a
new control element type, <code>WMPSpy</code>, for use in skin
definition (WMS) files.  This control has two properties,
<code>event</code> for the Girder event name, and <code>value</code>
the other for the associated value.  The control will normally not be
visible and will normally use a <code>wmpprop:</code> listening
attribute.  The sample WMPSpy.wmz skin package (really a ZIP file)
shows how to do this; it is based on Microsoft's <kbd>Classic</kbd>
skin.  It can be placed in the <kbd>c:\Program Files\Windows Media
Player\Skins</kbd> directory and then used with
<kbd>?WMPSkin=WMPSpy</kbd> in URLs for content to be displayed using
it.  This skin also makes the player full screen when playing, since
Girder is presumably used to control it directly and to display its
status someplace else.  More information on WMP skins is available in
the Windows Media Player SDK.<p>

In order for the Winamp plugin to be accessible, the file
<kbd>gen_DVDSpy.dll</kbd> needs to be copied into the
<kbd>Plugins</kbd> subdirectory of the Winamp installation directory,
which is usually <kbd>C:\Program Files\Winamp</kbd>.  Once installed,
the plugin can be configured from inside Winamp to set the interval
(in milliseconds) at which it checks for state changes.<p>

The registry key
<kbd>HKEY_CURRENT_USER\Software\Girder3\HardPlugins\DVDSpy\Events</kbd>
can contain string values that specify events that are generated by
means other than the hook.  This is needed for Learn mode to work
properly from inside Girder.  The file <kbd>DVDSpy.reg</kbd> installs
the events included in this package.<p>

The registry key
<kbd>HKEY_CURRENT_USER\Software\Girder3\HardPlugins\DVDSpy</kbd> can
contain a string value <kbd>DVDTitles</kbd> giving the name of a
comma-separated (CSV) flat file containing a database of disc titles.
The first line of the file is the name of the fields in the file.  The
file must at least contain fields named <kbd>Title</kbd> and
<kbd>Serial Number</kbd>.  It can have any number of additional
fields.<p>

If the disc is not included in the above database, then the PCFriendly
<kbd>disc.id</kbd> file, if present, is used for the title.
Otherwise, the volume name is used as a last resort.<p>

A good place to display the extracted text is on an LCD display, using
the LCD Software plug-in.  See the 
<a href="../../software/lcd/readme.htm">readme</a> file for that plug-in
for more details.  A sample Girder file is included that displays some
information in a format suitable for 4x20 displays.<p>

<h3>Extending</h3>

Sending a <code>WM_COPYDATA</code> message to the top-level window
whose name is <code>"Girder DVDSpy Monitor Window"</code> generates an
event inside Girder.  The <code>dwData</code> of the message is the
integer value, and the <code>lpData</code> is two adjacent
null-terminated strings for the event name and the string value,
respectively.  The <code>cbData</code> must be the entire length,
including the second null character.<p>

This is how the WMP and Winamp interfaces work.<p>

<h3>Disclaimer</h3>
You use this plug-in at your own risk.

<h3>Contact</h3>
To report problems or make suggestions, post a message to the Girder
forum, rather than sending email directly.

</body>

</html>
